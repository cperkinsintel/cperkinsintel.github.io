<!DOCTYPE html>
<html>
  <head>
    <title>Collage of Tears</title>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  </head>
  <body>
    <div class="fc">
      <div>
        <header><h1>Welcome to the Collage of Tears</h1></header>
        <button onclick="say_hi()">Flash!</button>
      </div>
      <!-- <iframe id="flasher" src="//127.0.0.1:3001/"></iframe> -->
    </div>
    <script>
      
      
      function say_hello(){
        var flasher = document.getElementById("flasher");
        flasher.contentWindow.postMessage("message-hi", "*");
        
        var object = {dd:"ddd", sub:{xx:"dd"}, num:666};
        var string = JSON.stringify(object);
        var uint8_array = new TextEncoder(document.characterSet.toLowerCase()).encode(string);
        var array_buffer = uint8_array.buffer;
        // now transfer array buffer
        flasher.contentWindow.postMessage(array_buffer, "*", [array_buffer])
        //console.log("len after transfer", array_buffer.length );
      }
      
      function say_hi(){
        $.ajax({
          url: "https://127.0.0.1:3001/hi",
          //method:"POST"
          })
        .then(function(d){
          console.log("HI response: ", d);
        })
        .fail(function(er){
          console.log("FAIL: ", er);
        });
      }
    </script>
  </body>
</html>
